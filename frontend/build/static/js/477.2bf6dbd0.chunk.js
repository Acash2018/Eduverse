"use strict";(self.webpackChunkeduverse=self.webpackChunkeduverse||[]).push([[477],{2477:(e,s,a)=>{a.r(s),a.d(s,{default:()=>r});var t=a(5043),n=a(579);const r=()=>{const[e,s]=(0,t.useState)(""),[a,r]=(0,t.useState)([]),[c,l]=(0,t.useState)([]),[i,u]=(0,t.useState)(null),[o,d]=(0,t.useState)(!1),[m,h]=(0,t.useState)(!1),f=(0,t.useRef)(null),p=(0,t.useRef)(null);(0,t.useEffect)((()=>{const e=f.current;e.classList.add("fade-in");const s=Array.from({length:50},(()=>{const s=document.createElement("div");return s.className="particle",e.appendChild(s),s}));return s.forEach((e=>{j(e)})),p.current.classList.add("slide-in"),()=>{s.forEach((e=>e.remove()))}}),[]),(0,t.useEffect)((()=>{(async()=>{try{const e=await fetch("/api/user/current"),s=await e.json();u(s)}catch(e){console.error("Error fetching current user:",e)}})()}),[]),(0,t.useEffect)((()=>{const s=setTimeout((async()=>{if(e.length>0){d(!0);try{const s=await fetch(`/api/users/search?query=${encodeURIComponent(e)}`),a=await s.json(),t=await Promise.all(a.map((async e=>{const s=await fetch(`/api/users/${e.id}/mutuals`),a=await s.json();return{...e,mutualConnections:a.mutuals,mutualCount:a.count}})));r(t)}catch(s){console.error("Error fetching suggestions:",s)}finally{d(!1)}}else r([])}),300);return()=>clearTimeout(s)}),[e]);const j=e=>e.animate([{transform:`translate(${100*Math.random()}vw, ${100*Math.random()}vh)`,opacity:0},{transform:`translate(${100*Math.random()}vw, ${100*Math.random()}vh)`,opacity:.5}],{duration:3e3+2e3*Math.random(),iterations:1/0});return(0,n.jsxs)("div",{className:"search-container",ref:f,children:[(0,n.jsxs)("form",{onSubmit:async s=>{if(s.preventDefault(),e){d(!0),h(!1),(()=>{const e=f.current,s=document.createElement("div");s.className="rocket",e.appendChild(s),setTimeout((()=>{s.remove(),h(!0)}),2e3)})();try{const s=await fetch(`/api/users/search?query=${encodeURIComponent(e)}&detailed=true`),a=await s.json();setTimeout((()=>{l(a),d(!1)}),2e3)}catch(a){console.error("Error performing search:",a),d(!1)}}},className:"search-bar",ref:p,children:[(0,n.jsx)("input",{type:"text",placeholder:"Search for people...",value:e,onChange:e=>s(e.target.value),onFocus:e=>e.target.classList.add("focused"),onBlur:e=>e.target.classList.remove("focused"),autoComplete:"off"}),(0,n.jsx)("button",{type:"submit",disabled:o,children:o?"Searching...":"Search"})]}),o&&(0,n.jsx)("div",{className:"loading-spinner",children:"Loading..."}),a.length>0&&(0,n.jsx)("ul",{className:"suggestions-list",children:a.map((e=>(0,n.jsxs)("li",{onClick:()=>(async e=>{try{const a=await fetch(`/api/users/${e}`),t=await a.json();s(t.name),l([t]),r([])}catch(a){console.error("Error fetching user details:",a)}})(e.id),className:"suggestion-item",children:[(0,n.jsx)("img",{src:e.profileImage,alt:e.name,className:"user-avatar"}),(0,n.jsxs)("div",{className:"user-info",children:[(0,n.jsx)("h4",{children:e.name}),(0,n.jsx)("p",{className:"user-title",children:e.title}),(0,n.jsx)("div",{className:"mutual-connections",children:e.mutualCount>0&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("span",{className:"mutual-count",children:[e.mutualCount," mutual connections"]}),(0,n.jsx)("div",{className:"mutual-preview",children:e.mutualConnections.slice(0,3).map((e=>(0,n.jsx)("span",{className:"mutual-name",children:e.name},e.id)))})]})})]})]},e.id)))}),m&&c.length>0&&(0,n.jsxs)("div",{className:"search-results",children:[(0,n.jsx)("h3",{children:"Search Results"}),(0,n.jsx)("ul",{children:c.map(((e,s)=>(0,n.jsxs)("li",{className:"result-item",style:{animationDelay:.1*s+"s"},onClick:()=>{document.querySelector(`[data-user-id="${e.id}"]`).classList.add("expanded")},"data-user-id":e.id,children:[(0,n.jsx)("img",{src:e.profileImage,alt:e.name,className:"user-avatar"}),(0,n.jsxs)("div",{className:"user-info",children:[(0,n.jsx)("h4",{children:e.name}),(0,n.jsx)("p",{className:"user-title",children:e.title}),(0,n.jsx)("p",{className:"user-location",children:e.location}),e.mutualCount>0&&(0,n.jsxs)("div",{className:"mutual-connections",children:[(0,n.jsxs)("h5",{children:["Mutual Connections (",e.mutualCount,")"]}),(0,n.jsx)("ul",{className:"mutual-list",children:e.mutualConnections.map((e=>(0,n.jsx)("li",{children:e.name},e.id)))})]})]})]},e.id)))})]})]})}}}]);
//# sourceMappingURL=477.2bf6dbd0.chunk.js.map